<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
	http://www.springframework.org/schema/security
	http://www.springframework.org/schema/security/spring-security-4.0.xsd">

    <global-method-security proxy-target-class="true" pre-post-annotations="enabled" secured-annotations="enabled" />

    <http pattern="/resources/**" security="none"/>
    <http pattern="/template/**" security="none" />
 	<http pattern="/favicon.ico" security="none" />
 	<http pattern="/googleb3308ed71bf2ce38.html" security="none" />
 	
<!--     <http pattern="/webService/maling/**" security="none" > -->
<!--        	<intercept-url pattern="/webService/maling/send" access="permitAll()"/> -->
<!--    		<csrf disabled="true"/> -->

    

    <http use-expressions="true" auto-config="true"  >
<!--     	<intercept-url pattern="/webService/maling/**" access="hasRole('ANONYMOUS')"/> -->
		<intercept-url pattern="/canjeProducto/finalizar/*" access="permitAll()" />
		<intercept-url pattern="/canjeProducto/listarResumenCarrito" access="permitAll()" />
    	<intercept-url pattern="/canjeProducto/pendientes" access="permitAll()" />
    	<intercept-url pattern="/canjeProducto/paso1/**" access="permitAll()" />
    	<intercept-url pattern="/carritoProducto/**" access="permitAll()" />  	
    	<intercept-url pattern="/configProvided*/**" access="permitAll()" />
    	<intercept-url pattern="/resetConfigProvided" access="permitAll()" />
    	<intercept-url pattern="/sitemap*" access="permitAll()" />
    	<intercept-url pattern="/criteo*" access="permitAll()" />
    	<intercept-url pattern="/robots*" access="permitAll()" />
		<intercept-url pattern="/error/**" access="permitAll()" />
		<intercept-url pattern="/zonaPublica**" access="permitAll()" />
		<intercept-url pattern="/que-es-interbank-benefit" access="permitAll()" />
		<intercept-url pattern="/benefit-navidad" access="permitAll()"/>
		<intercept-url pattern="/cyberwow" access="permitAll()"/>
		
		<intercept-url pattern="/scorpio" access="permitAll()"/>
		<intercept-url pattern="/categorias" access="permitAll()"/>
		<intercept-url pattern="/c/**" access="permitAll()"/>
		<intercept-url pattern="/p/**" access="permitAll()"/>
		<intercept-url pattern="/productos/**" access="permitAll()"/>
		<intercept-url pattern="/experiencias" access="permitAll()"/>
		<intercept-url pattern="/eventos" access="permitAll()"/>
		<intercept-url pattern="/e/**" access="permitAll()"/>
		<intercept-url pattern="/ficha-producto/**" access="permitAll()"/>
		<intercept-url pattern="/carrito" access="permitAll()"/>
		<intercept-url pattern="/vales" access="permitAll()"/>
		<intercept-url pattern="/v/**" access="permitAll()"/>
		<intercept-url pattern="/mis-canjes/**" access="permitAll()"/>
		<intercept-url pattern="/404" access="permitAll()"/>

		<intercept-url pattern="/conocer-uso-de-millas" access="permitAll()" />
		<intercept-url pattern="/terminos-y-condiciones" access="permitAll()" />
		<intercept-url pattern="/terminos-y-condiciones/listar" access="permitAll()" />
		
		<intercept-url pattern="/preguntas-frecuentes" access="permitAll()" />
		<intercept-url pattern="/mapa-de-sitio" access="permitAll()" />
		
		<intercept-url pattern="/acceso/**" access="permitAll()" />
		<intercept-url pattern="/common/**" access="permitAll()" />
		<intercept-url pattern="/webService/**" access="permitAll()"/>
		<intercept-url pattern="/compras/**" access="permitAll()" />
		
		<intercept-url pattern="/producto/**" access="permitAll()" />
		<intercept-url pattern="/marca/**" access="permitAll()" />
		
		<intercept-url pattern="/viajes/compra/**" access="hasRole('ROLE_USER')" />
   		<intercept-url pattern="/viajes/**" access="permitAll()" />
   		<intercept-url pattern="/vuelos/**" access="permitAll()" />
   		
   		<intercept-url pattern="/inicio/**" access="permitAll()" />
   		<intercept-url pattern="/entretenimiento/**" access="permitAll()" />
   		<intercept-url pattern="/descuento/**" access="permitAll()" />
   		<intercept-url pattern="/promocion/**" access="permitAll()" />
   		<intercept-url pattern="/promociones/**" access="permitAll()" />
   		
   		<intercept-url pattern="/registrate/**" access="permitAll()" />
   		<intercept-url pattern="/ingresar/**" access="permitAll()" />
   		
   		<intercept-url pattern="/vales-digitales/carrito/**" access="hasRole('ROLE_USER')" />
   		<intercept-url pattern="/vales-digitales/paso1/**" access="hasRole('ROLE_USER')" />
   		<intercept-url pattern="/vales-digitales/paso2/**" access="hasRole('ROLE_USER')" />
   		<intercept-url pattern="/vales-digitales/finalizar/**" access="hasRole('ROLE_USER')" />
   		<intercept-url pattern="/vales-digitales/pendientes" access="hasRole('ROLE_USER')" />
   		
   		<intercept-url pattern="/vales-digitales/**" access="permitAll()" />
   		<intercept-url pattern="/vales-fisicos/**" access="permitAll()" />
   		<intercept-url pattern="/vales/**" access="permitAll()" />
   		
   		<intercept-url pattern="/microservice-producto/**" access="permitAll()"/>
   		<intercept-url pattern="/microservice-joinnus/**" access="permitAll()"/>
   		<intercept-url pattern="/experiencias/compra/**" access="hasRole('ROLE_USER')"/>
   		
   		<intercept-url pattern="/canje-en-locales-afiliados/**" access="permitAll()" />
   		<intercept-url pattern="/evento/**" access="permitAll()" />
   		
   		<intercept-url pattern="/" access="permitAll()" /> 
		
   		<intercept-url pattern="/**" access="hasRole('ROLE_USER')"  /> 
   		

	  
	 <form-login login-page="/acceso/autenticacionToken" default-target-url="/home" login-processing-url="/login"
       authentication-failure-url="/acceso/login?error" username-parameter="username" password-parameter="password" 
       authentication-success-handler-ref="loginSuccessHandler"/>

<!-- 	 <form-login login-page="/acceso/autenticacionToken" default-target-url="/home" login-processing-url="/login" -->
<!--        authentication-failure-url="/acceso/login?error" username-parameter="username" password-parameter="password"  -->
<!--        authentication-success-handler-ref="authenticationSuccessHandler"  -->
<!--        authentication-failure-handler-ref="authenticationFailureHandler" -->
<!--        /> -->

      

        <session-management session-fixation-protection="migrateSession">
        </session-management>

<!--         <session-management session-authentication-error-url="/acceso/login?error=SessionInvalid"> -->
<!--             <concurrency-control max-sessions="1" expired-url="/acceso/login" error-if-maximum-exceeded="true" /> -->
<!--         </session-management> -->
        <csrf  />
        
        


	    <headers>
	        <frame-options policy="ALLOW-FROM"   strategy="whitelist"  value="saapp.com,interbankbenefit.pe,interbank.marketing.adobe.com,us1-proxy.adobemc.com" />
	     </headers>
        
     </http>

    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="userDetailsService" />
    </authentication-manager>
   
    <beans:bean id="csrfFilter" class="org.springframework.security.web.csrf.CsrfFilter">
        <beans:constructor-arg>
            <beans:bean class="org.springframework.security.web.csrf.HttpSessionCsrfTokenRepository" />
        </beans:constructor-arg>
    </beans:bean>
    
    <beans:bean id="requestDataValueProcessor" class="org.springframework.security.web.servlet.support.csrf.CsrfRequestDataValueProcessor" />
    
</beans:beans>
